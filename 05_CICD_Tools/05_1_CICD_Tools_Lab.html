<!DOCTYPE html><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="generator" content="Asciidoctor 0.1.4"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>CI/CD Tools Lab</title><style>@import url(http://cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.0/css/font-awesome.css);
/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased, body { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, #content #toctitle, .admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .mathblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title, .tableblock > caption { line-height: 1.4; color: #003b6b; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #00579e; text-decoration: none; line-height: inherit; }
a:hover, a:focus { color: #333333; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: Arial, sans-serif; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: Arial, sans-serif; font-weight: normal; font-style: normal; color: #7b2d00; text-rendering: optimizeLegibility; margin-top: 0.5em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #ff6b15; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: bold; color: #003426; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; list-style-position: outside; font-family: Arial, sans-serif; }

ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3em; font-weight: bold; }
dl dd { margin-bottom: 0.75em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: black; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 0.75em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #e15200; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #e15200; }

blockquote, blockquote p { line-height: 1.6; color: #333333; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Print styles.  Inlined to avoid required HTTP connection: www.phpied.com/delay-loading-your-print-css/ Credit to Paul Irish and HTML5 Boilerplate (html5boilerplate.com)
*/
.print-only { display: none !important; }

@media print { * { background: transparent !important; color: #000 !important; /* Black prints faster: h5bp.com/s */ box-shadow: none !important; text-shadow: none !important; }
  a, a:visited { text-decoration: underline; }
  a[href]:after { content: " (" attr(href) ")"; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after { content: ""; }
  pre, blockquote { border: 1px solid #999; page-break-inside: avoid; }
  thead { display: table-header-group; /* h5bp.com/t */ }
  tr, img { page-break-inside: avoid; }
  img { max-width: 100% !important; }
  @page { margin: 0.5cm; }
  p, h2, h3, #toctitle, .sidebarblock > .content > .title { orphans: 3; widows: 3; }
  h2, h3, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
  .hide-on-print { display: none !important; }
  .print-only { display: block !important; }
  .hide-for-print { display: none !important; }
  .show-for-print { display: inherit !important; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #d8d8ce; }
/* Change -webkit-linear-gradient colors to  #a70000 and remove gradient */
table thead, table tfoot { background: -webkit-linear-gradient(top, #a70000, #a70000); font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: white; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #6d6e71; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #edf2f2; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

a:hover, a:focus { text-decoration: underline; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; padding: 3px 2px 1px 2px; white-space: nowrap; background-color: #eeeeee; border: 1px solid #dddddd; -webkit-border-radius: 0; border-radius: 0; text-shadow: none; }

pre, pre > code { line-height: 1.6; color: black; font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; }

kbd.keyseq { color: #333333; }

kbd:not(.keyseq) { display: inline-block; color: black; font-size: 0.75em; line-height: 1.4; background-color: #F7F7F7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }

kbd kbd:first-child { margin-left: 0; }

kbd kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: black; }

b.button:before { content: '[ '; }

b.button:after { content: ' ]'; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 1.5em; padding-right: 1.5em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#header { margin-bottom: 2.5em; }
#header > h1 { color: #7b2d00; font-weight: normal; border-bottom: 1px solid #dddddd; margin-bottom: -28px; padding-bottom: 32px; }
#header span { color: #333333; }
#header #revnumber { text-transform: capitalize; }
#header br { display: none; }
#header br + span { padding-left: 3px; }
#header br + span:before { content: "\2013 \0020"; }
#header br + span.author { padding-left: 0; }
#header br + span.author:before { content: ", "; }

#toc { border-bottom: 1px solid #dddddd; padding-bottom: 1.25em; }
#toc > ul { margin-left: 0.25em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
#toc ul { list-style-type: none; }

#toctitle { color: #003b6b; }

@media only screen and (min-width: 768px) { body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #dddddd; border-bottom: 0; z-index: 1000; padding: 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: .90em; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; border-width: 0; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }
#content #toc a { text-decoration: none; }

#content #toctitle { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-size: 1em; padding-left: 0.125em; }

#footer { max-width: 100%; background-color: none; padding: 1.25em; }

#footer-text { color: black; line-height: 1.44; }

.sect1 { padding-bottom: 1.25em; }

.sect1 + .sect1 { border-top: 1px solid #dddddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; width: 1em; margin-left: -1em; display: block; text-decoration: none; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: '\00A7'; font-size: .85em; vertical-align: text-top; display: block; margin-top: 0.05em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #7b2d00; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #622400; }

.imageblock, .literalblock, .listingblock, .mathblock, .verseblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .mathblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-align: left; font-weight: bold; }

.tableblock > caption { text-align: left; font-weight: bold; white-space: nowrap; overflow: visible; max-width: 0; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #333333; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6, .exampleblock > .content p { color: #333333; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6 { line-height: 1; margin-bottom: 0.625em; }
.exampleblock > .content h1.subheader, .exampleblock > .content h2.subheader, .exampleblock > .content h3.subheader, .exampleblock > .content .subheader#toctitle, .sidebarblock.exampleblock > .content > .subheader.title, .exampleblock > .content h4.subheader, .exampleblock > .content h5.subheader, .exampleblock > .content h6.subheader { line-height: 1.4; }

.exampleblock.result > .content { -webkit-box-shadow: 0 1px 8px #aaaaaa; box-shadow: 0 1px 8px #aaaaaa; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6, .sidebarblock p { color: #333333; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6 { line-height: 1; margin-bottom: 0.625em; }
.sidebarblock h1.subheader, .sidebarblock h2.subheader, .sidebarblock h3.subheader, .sidebarblock .subheader#toctitle, .sidebarblock > .content > .subheader.title, .sidebarblock h4.subheader, .sidebarblock h5.subheader, .sidebarblock h6.subheader { line-height: 1.4; }
.sidebarblock > .content > .title { color: #003b6b; margin-top: 0; line-height: 1.6; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre:not([class]), .listingblock pre:not([class]) { background: #eeeeee; }
.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { border-width: 1px; border-style: dashed; border-color: #666666; -webkit-border-radius: 0; border-radius: 0; padding: 1.25em 1.5625em 1.125em 1.5625em; word-wrap: break-word; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
.literalblock pre > code, .literalblock pre[class] > code, .listingblock pre > code, .listingblock pre[class] > code { display: block; }
@media only screen { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.72em; } }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.81em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.9em; } }

.listingblock pre.highlight { padding: 0; }
.listingblock pre.highlight > code { padding: 1.25em 1.5625em 1.125em 1.5625em; }

.listingblock > .content { position: relative; }

.listingblock:hover code[class*=" language-"]:before { text-transform: uppercase; font-size: 0.9em; color: #999; position: absolute; top: 0.375em; right: 0.375em; }

.listingblock:hover code.asciidoc:before { content: "asciidoc"; }
.listingblock:hover code.clojure:before { content: "clojure"; }
.listingblock:hover code.css:before { content: "css"; }
.listingblock:hover code.groovy:before { content: "groovy"; }
.listingblock:hover code.html:before { content: "html"; }
.listingblock:hover code.java:before { content: "java"; }
.listingblock:hover code.javascript:before { content: "javascript"; }
.listingblock:hover code.python:before { content: "python"; }
.listingblock:hover code.ruby:before { content: "ruby"; }
.listingblock:hover code.sass:before { content: "sass"; }
.listingblock:hover code.scss:before { content: "scss"; }
.listingblock:hover code.xml:before { content: "xml"; }
.listingblock:hover code.yaml:before { content: "yaml"; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: '$'; }

table.pyhltable { border: 0; margin-bottom: 0; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

.highlight.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }

.highlight.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background-color: transparent !important; padding-right: 0 !important; }

.quoteblock { margin: 0 0 0.75em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
.quoteblock blockquote { margin: 0 0 0.75em 0; padding: 0 0 0.5625em 0; border: 0; }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: -.25em; padding-bottom: 0.5625em; font-size: 0.8125em; color: #e15200; }
.quoteblock .attribution br { display: none; }
.quoteblock .attribution cite { display: block; margin-bottom: 0.625em; }

table thead th, table tfoot th { font-weight: bold; }

table.tableblock.grid-all { border-collapse: separate; border-spacing: 1px; -webkit-border-radius: 0; border-radius: 0; border-top: 1px solid #dddddd; border-bottom: 1px solid #dddddd; }

table.tableblock.frame-topbot, table.tableblock.frame-none { border-left: 0; border-right: 0; }

table.tableblock.frame-sides, table.tableblock.frame-none { border-top: 0; border-bottom: 0; }

table.tableblock td .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

th.tableblock.halign-left, td.tableblock.halign-left { text-align: left; }

th.tableblock.halign-right, td.tableblock.halign-right { text-align: right; }

th.tableblock.halign-center, td.tableblock.halign-center { text-align: center; }

th.tableblock.valign-top, td.tableblock.valign-top { vertical-align: top; }

th.tableblock.valign-bottom, td.tableblock.valign-bottom { vertical-align: bottom; }

th.tableblock.valign-middle, td.tableblock.valign-middle { vertical-align: middle; }

tbody tr th { display: table-cell; line-height: 1.4; background: -webkit-linear-gradient(top, #add386, #90b66a); }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: white; font-weight: bold; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.375em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > i[class^="icon-check"]:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.375em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1 { padding-right: .8em; font-weight: bold; }

td.hdlist1, td.hdlist2 { vertical-align: top; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 .8em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.qanda > ol > li > p > em:only-child { color: #004985; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; }

span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }

#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: none; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > [class^="icon-"], span.icon > [class*=" icon-"] { cursor: default; }

.admonitionblock td.icon [class^="icon-"]:before { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #00579e; color: #004176; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum { display: inline-block; color: white !important; background-color: black; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; width: 20px; height: 20px; font-size: 12px; font-weight: bold; line-height: 20px; font-family: Arial, sans-serif; font-style: normal; position: relative; top: -2px; letter-spacing: -1px; }
.conum * { color: white !important; }
.conum + b { display: none; }
.conum:after { content: attr(data-value); }
.conum:not([data-value]):empty { display: none; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { border-bottom: 1px solid #dddddd; }

#toctitle { color: #00406F; font-weight: normal; margin-top: 1.5em; }

.sidebarblock { border-color: #aaa; }

code { -webkit-border-radius: 4px; border-radius: 4px; }

p.tableblock.header { color: #6d6e71; }</style><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/3.2.0/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/sunburst.min.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script><script>hljs.initHighlightingOnLoad()</script></head><body class="article toc2 toc-left"><div id="header"><div id="toc" class="toc2"><div id="toctitle">Table of Contents</div><ul class="sectlevel1">
<li><a href="#_ci_cd_tools_lab">CI/CD Tools Lab</a></li>
<li><a href="#labexercises">Check External Route for Registry</a></li>
<li><a href="#_set_up_nexus">Set Up Nexus</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_configure_nexus">Configure Nexus</a></li>
<li><a href="#_set_up_nexus_2">Set up Nexus</a></li>
</ul>
</li>
<li><a href="#_set_up_sonarqube">Set Up SonarQube</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_install_code_openshift_tasks_code_source_code_into_gogs">Install <code>openshift-tasks</code> Source Code into Gogs</a></li>
</ul>
</li>
<li><a href="#_set_up_jenkins">Set Up Jenkins</a></li>
<li><a href="#_work_with_custom_jenkins_agent_pod">Work with Custom Jenkins Agent Pod</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_create_custom_jenkins_agent_pod">Create Custom Jenkins Agent Pod</a></li>
<li><a href="#_register_custom_agent_pod_in_jenkins">Register Custom Agent Pod in Jenkins</a></li>
<li><a href="#_test_custom_agent_pod">Test Custom Agent Pod</a></li>
</ul>
</li>
<li><a href="#_use_a_configmap_to_register_agent_pod">Use a ConfigMap to register Agent Pod</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_test_second_agent_pod">Test Second Agent Pod</a></li>
</ul>
</li>
<li><a href="#_test_local_workstation_build">Test Local Workstation Build</a></li>
</ul></div></div><div id="content"><div class="sect1"><h2 id="_ci_cd_tools_lab">CI/CD Tools Lab</h2><div class="sectionbody"><div class="paragraph"><p>In this lab, you create the foundation for the practice of continuous integration and continuous deployment (CI/CD).
You set up all of the tools necessary to build a complex pipeline in a later lab.
The build process integrates Gogs, Nexus, SonarQube, and S2I builds.</p></div>
<div class="paragraph"><p>Because you are using a shared environment, make sure to prefix every project/namespace with <code>GUID-</code>, where "GUID" is your assigned GUID.
For example, if the project name is <code>nexus</code> and your GUID is <code>c3po</code>, the prefixed string becomes <code>c3po-nexus</code>.</p></div>
<div class="ulist"><div class="title">Goals</div><ul><li><p>Set up Nexus 3 with persistent storage and configure Nexus to cache Red Hat and other build artifacts.</p></li><li><p>Set up SonarQube with persistent storage and with PostgreSQL as the back end.</p></li><li><p>Set up Jenkins with persistent storage.</p></li><li><p>Perform a local workstation build that tests whether all tools are set up and configured correctly.</p></li></ul></div></div></div>
<div class="sect1"><h2 id="labexercises">Check External Route for Registry</h2><div class="sectionbody"><div class="paragraph"><p>By default the external route for image registry is not created in an OpenShift 4 cluster.
We need it in some of our exercises so we have created it beforehand in our lab environment.
Check if you can access it by inspecting one of the existing images.</p></div>
<div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh"># Set your REGISTRY variable to the proper route
export REGISTRY=default-route-openshift-image-registry.apps.$(oc whoami --show-server | cut -d. -f2- | cut -d: -f1)
echo ${REGISTRY}

# Log into the registry using Podman, use your username and the token as the password
podman login -u $(oc whoami) -p $(oc whoami -t) ${REGISTRY}</code></pre></div></div>
<div class="paragraph"><p>If you can&#8217;t access the registry, ask your cluster administrator to create an external route for it and give you the route&#8217;s FQDN. It can be done by adding the following line: <code>"defaultRoute": true</code> to Image Registry operator config <code>configs.imageregistry.operator.openshift.io/cluster</code> right after the <code>spec:</code> line.</p></div>
<div class="admonitionblock tip"><table><tr><td class="icon"><i class="icon-tip" title="Tip"></i></td><td class="content">The administrator can use the command <code>oc patch --type=merge configs.imageregistry cluster --patch='{"spec": {"defaultRoute": true}}'</code> to update the registry.</td></tr></table></div>
<div class="paragraph"><p>If the route exists, but you receive this authentication error:</p></div>
<div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">Error: error authenticating creds for "default-route-openshift-image-registry.apps.cluster-19ae.sandbox478.opentlc.com": pinging docker registry returned: Get https://default-route-openshift-image-registry.apps.cluster-19ae.sandbox478.opentlc.com/v2/: x509: certificate signed by unknown authority</code></pre></div></div>
<div class="paragraph"><p>This means you should add your cluster registry to the list of <em>insecure</em> registries in the <code>/etc/containers/registries.conf</code> file.
Open the file with your favorite text editor and add your registry address (get it from <code>echo $REGISTRY</code> or from the error message you&#8217;ve just received).
It should look like this:</p></div>
<div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh"># If you need to access insecure registries, add the registry's fully-qualified name.
# An insecure registry is one that does not have a valid SSL certificate or only does HTTP.
[registries.insecure]
registries = ['default-route-openshift-image-registry.apps.cluster-19ae.sandbox478.opentlc.com']</code></pre></div></div>
<div class="paragraph"><p>After that repeat your login attempt and try to run the <code>skopeo</code> command to confirm you can access the registry.</p></div>
<div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">podman login ${REGISTRY}
skopeo inspect docker://${REGISTRY}/openshift/python</code></pre></div></div></div></div>
<div class="sect1"><h2 id="_set_up_nexus">Set Up Nexus</h2><div class="sectionbody"><div class="ulist"><ul><li><p>Sonatype provides a Nexus 3 image labeled <code>sonatype/nexus3:3.21.2</code> in DockerHub.</p></li><li><p>Use the <code>Recreate</code> deployment strategy rather than <code>Rolling</code> to set up Nexus.</p></li><li><p>Nexus requires a large amount of memory. It is suggested that you set the memory request to <code>1Gi</code> and the memory limit to <code>2Gi</code>.</p></li><li><p>Nexus also requires significant CPU - at least for the initial deployment. It is suggested that you set the CPU request to <code>500m</code> and the CPU limit to <code>2</code>.</p></li><li><p>The Nexus 3 image defines a <code>volumeMount</code> at <code>/nexus-data</code>. This volume is used to cache all build dependencies, store build artifacts and container images. A size of 10GB should be sufficient.</p></li></ul></div>
<div class="paragraph"><p>Follow these steps to set up Nexus:</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Create a new project named <code>GUID-nexus</code> with display name <code>GUID Shared Nexus</code>, replacing <code>GUID</code> with your assigned GUID.</p></li><li><p>Deploy the Nexus container image and create a route to the Nexus service. Because you are making a few changes to the deployment configuration, you may want to pause the automatic deployment upon configuration changes.</p><div class="paragraph"><p><em>Make sure the application name is <code>nexus</code> and not <code>nexus3</code>.</em></p></div></li><li><p>Change the deployment strategy from <code>Rolling</code> to <code>Recreate</code> and set requests and limits for memory and CPU.</p></li><li><p>Create a persistent volume claim (PVC) and mount it at <code>/nexus-data</code>.</p></li><li><p>Set up appropriate liveness and readiness probes for Nexus.</p></li><li><p>Finally, resume deployment of the Nexus deployment configuration to roll out all changes at once.</p></li></ol></div>
<div class="sect2"><h3 id="_configure_nexus">Configure Nexus</h3><div class="olist arabic"><ol class="arabic"><li><p>Once Nexus is deployed, set up your Nexus repository using the provided script.
Use the Nexus default user ID (<code>admin</code>). The default password for <code>admin</code> user is
stored in the Nexus pod in the <code>/nexus-data/admin.password</code> file.
Use the <code>oc rsh</code> command to get into the Nexus pod and retrieve the password.</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="bash language-bash">oc get pods

export NEXUS_PASSWORD=$(oc rsh &lt;your-nexus-pod&gt; cat /nexus-data/admin.password)
echo $NEXUS_PASSWORD</code></pre></div></div></li><li><p>With recent changes to Nexus, you must enable the ability to use a script to allow creation of proxies, repositories, etc. in Nexus.
You can enable this by manually adding <code>nexus.scripts.allowCreation=true</code> to the <code>/nexus-data/etc/nexus.properties</code> file in the Nexus Pod.
However, doing this manually should not be a method you follow.
With a <code>DeploymentConfig</code>, you can use a <code>deployment-hook</code> to do this for you.</p><div class="listingblock"><div class="content"><pre class="highlight nowrap"><code class="bash language-bash">oc set deployment-hook dc/nexus --mid --volumes=nexus-volume-1 \
-- /bin/sh -c "echo nexus.scripts.allowCreation=true &gt;./nexus-data/etc/nexus.properties"
oc rollout latest dc/nexus
watch oc get po</code></pre></div></div>
<div class="admonitionblock tip"><table><tr><td class="icon"><i class="icon-tip" title="Tip"></i></td><td class="content">While there are a number of ways you could accomplish the task above, another method would be using an <code>initContainer</code> in your Pod spec.
It can be as simple as using a <code>busybox</code> container image and running the same command.
See <a href="https://github.com/redhat-gpte-devopsautomation/ansible-operator-roles/blob/master/roles/nexus-ocp/templates/deployment.j2#L19-L25" target="_blank">this example</a>.</td></tr></table></div></li><li><p>With the script option enabled and your Nexus Pod <strong>Ready</strong> and <strong>Running</strong>, you can now proceed with executing the setup script.</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="bash language-bash">cd $HOME
curl -o setup_nexus3.sh -s https://raw.githubusercontent.com/redhat-gpte-devopsautomation/ocp_advanced_development_resources/master/nexus/setup_nexus3.sh
chmod +x setup_nexus3.sh
./setup_nexus3.sh admin $NEXUS_PASSWORD http://$(oc get route nexus --template='{{ .spec.host }}')
rm setup_nexus3.sh</code></pre></div></div>
<div class="ulist"><ul><li><p>This script creates:</p><div class="ulist"><ul><li><p>A few Maven proxy repositories to cache Red Hat and JBoss dependencies.</p></li><li><p>A <code>maven-all-public</code> group repository that contains the proxy repositories for all of the required artifacts.</p></li><li><p>An NPM proxy repository to cache Node.JS build artifacts.</p></li><li><p>A private Docker registry.</p></li><li><p>A <code>releases</code> repository for the WAR files that are produced by your pipeline.</p></li><li><p>A Docker registry in Nexus listening on port 5000. OpenShift does not know about this additional endpoint, so you need to create an additional route that exposes the Nexus Docker registry for your use.</p></li></ul></div></li><li><p>Ensure that the script succeeded by checking the HTTP return codes. You should see <code>HTTP/1.1 200 OK</code>.</p></li></ul></div></li><li><p>Create the following:</p><div class="ulist"><ul><li><p>A Service called <code>nexus-registry</code> that exposes port 5000 from the deployment configuration <code>nexus</code>.</p></li><li><p>Create an OpenShift route called <code>nexus-registry</code> that uses <code>edge</code> termination for the TLS encryption and exposes port 5000.</p></li></ul></div></li><li><p>Confirm your routes:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="bash language-bash">oc get routes -n ${GUID}-nexus</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight"><code class="text language-text">NAME             HOST/PORT                                                             PATH   SERVICES         PORT       TERMINATION   WILDCARD
nexus            nexus-b676-nexus.apps.shared-dev.dev.openshift.opentlc.com                   nexus            8081-tcp                 None
nexus-registry   nexus-registry-b676-nexus.apps.shared-dev.dev.openshift.opentlc.com          nexus-registry   5000       edge          None</code></pre></div></div></li></ol></div></div>
<div class="sect2"><h3 id="_set_up_nexus_2">Set up Nexus</h3><div class="olist arabic"><ol class="arabic"><li><p>Using the route that you retrieved above for your Nexus, with <code>admin</code> as the ID and the $NEXUS_PASSWORD as the password, log into your Nexus using a web browswer.</p></li><li><p>You will see the "Welcome" wizard that prompts you to select a new password for admin.</p><div class="ulist"><ul><li><p>Use <code>app_deploy</code> as the new password.</p></li></ul></div></li><li><p>When prompted to <strong>Configure Anonymous Access</strong> select the Checkbox to allow anonymous access and click <strong>Next</strong>.</p></li><li><p>Click <strong>Finish</strong> to exit the wizard.</p></li><li><p>You may double check that all the repositories (docker, maven-all-public, redhat-ga) are listed under repositories.</p></li><li><p>Then you can close your browser window again.</p></li></ol></div></div></div></div>
<div class="sect1"><h2 id="_set_up_sonarqube">Set Up SonarQube</h2><div class="sectionbody"><div class="olist arabic"><ol class="arabic"><li><p>Create a new project called <code>GUID-sonarqube</code> with a display name of <code>GUID Shared Sonarqube</code>, replacing <code>GUID</code> with your assigned GUID.</p></li><li><p>Deploy a persistent PostgreSQL database.</p><div class="ulist"><ul><li><p>When deploying the template, pick sensible values for the <code>POSTGRESQL_USER</code>, <code>POSTGRESQL_PASSWORD</code>, <code>POSTGRESQL_DATABASE</code>, and <code>VOLUME_CAPACITY</code> parameters.</p></li></ul></div></li><li><p>Make sure that your database is fully up before moving to the next step.</p></li><li><p>Deploy the SonarQube image (<code>quay.io/gpte-devops-automation/sonarqube:7.9.1</code>) available in Quay.</p><div class="ulist"><ul><li><p>The image expects <code>SONARQUBE_JDBC_USERNAME</code>, <code>SONARQUBE_JDBC_PASSWORD</code>, and <code>SONARQUBE_JDBC_URL</code> in the environment.</p></li><li><p>The correct setting for <code>SONARQUBE_JDBC_URL</code> is <code>SONARQUBE_JDBC_URL=jdbc:postgresql://postgresql/&lt;dbname&gt;</code> where "&lt;dbname&gt;" is the name you picked when you set up PostgreSQL.</p><div class="admonitionblock tip"><table><tr><td class="icon"><i class="icon-tip" title="Tip"></i></td><td class="content">The source for the Sonarqube container image is located at <a href="https://github.com/wkulhanek/docker-openshift-sonarqube.git" target="_blank">https://github.com/wkulhanek/docker-openshift-sonarqube.git</a>.</td></tr></table></div></li></ul></div></li><li><p>Pause rollouts for the created SonarQube Deployment Configuration so you can make a few more changes.
If you do not pause, all of the following changes will try to roll out a new version of the DeploymentConfig.</p></li><li><p>Create a route for SonarQube.</p></li><li><p>Create a PVC (at least 5Gi in size) and mount it at <code>/opt/sonarqube/data</code>.</p></li><li><p>Set the resources.</p><div class="ulist"><ul><li><p>SonarQube is a heavy application. The following parameters are suggested:</p><div class="ulist"><ul><li><p>Memory request: 2Gi</p></li><li><p>Memory limit: 3Gi</p></li><li><p>CPU request: 1 CPU</p></li><li><p>CPU limit: 2 CPUs</p></li></ul></div></li></ul></div></li><li><p>Set the deployment strategy.
Because SonarQube is using <code>Elasticsearch</code> under the covers, it needs a <code>Recreate</code> deployment strategy rather than the default <code>Rolling</code> deployment strategy.</p></li><li><p>To ensure proper operation of your service, add liveness and readiness probes.</p></li><li><p>SonarQube uses Elasticsearch, which has some rather heavy requirements.
Add the label <code>tuned.openshift.io/elasticsearch: "true"</code> to the SonarQube Pods.
This ensures that the OpenShift 4 Tuned operator configures the node that the Sonarqube pod lands on correctly.
Remember, since this is controlled by a Deployment Config, you must make the change there, but you need to label the pods, <strong>not</strong> the deployment config!</p></li><li><p>Finally, resume deployment of the SonarQube deployment configuration to roll out all changes at once.</p></li><li><p>Once SonarQube has fully started, open your web browser and log in via the exposed route. The default user ID is <code>admin</code> and password is <code>admin</code>.</p></li></ol></div>
<div class="sect2"><h3 id="_install_code_openshift_tasks_code_source_code_into_gogs">Install <code>openshift-tasks</code> Source Code into Gogs</h3><div class="olist arabic"><ol class="arabic"><li><p>Open your Gogs Server in a web browser.</p></li><li><p>Register a new user account for yourself.</p><div class="admonitionblock tip"><table><tr><td class="icon"><i class="icon-tip" title="Tip"></i></td><td class="content">Use the same user name and pasword you are using for OpenShift.
While this is not required, it will decrease the liklihood of you forgetting what you are using.</td></tr></table></div></li><li><p>Log in to your Gogs server with your new user account.</p></li><li><p>Create an organization named <code>CICDLabs</code>.</p></li><li><p>Under the <code>CICDLabs</code> organization, create a repository called <code>openshift-tasks</code>.</p><div class="ulist"><ul><li><p>Do not make this a <code>Private</code> repository.</p></li></ul></div></li><li><p>On your client VM, clone the source code from GitHub and push it to Gogs:</p><div class="admonitionblock important"><table><tr><td class="icon"><i class="icon-important" title="Important"></i></td><td class="content"><div class="paragraph"><p>Make sure to replace <code>&lt;gogs_user&gt;</code> and <code>&lt;gogs_password&gt;</code> with your credentials.</p></div></td></tr></table></div>
<div class="listingblock"><div class="content"><pre class="highlight"><code class="bash language-bash">cd $HOME
git clone https://github.com/redhat-gpte-devopsautomation/openshift-tasks.git
cd $HOME/openshift-tasks
git remote add gogs http://&lt;gogs_user&gt;:&lt;gogs_password&gt;@$(oc get route gogs-gogs -n ${GUID}-gogs --template='{{ .spec.host }}')/CICDLabs/openshift-tasks.git
git push -u gogs master</code></pre></div></div></li><li><p>Set up <code>nexus_settings.xml</code> for local builds, making sure that <code>&lt;url&gt;</code> points to your specific Nexus URL replacing GUID with your specific GUID. Do not delete the path <code>/repository/maven-all-public</code>.</p><div class="paragraph"><p>Replace <code>admin123</code> with the <code>admin</code> user password <code>app_deploy</code> that you set earlier.</p></div>
<div class="listingblock"><div class="content"><pre class="highlight"><code class="xml language-xml">&lt;?xml version="1.0"?&gt;
&lt;settings&gt;
  &lt;mirrors&gt;
    &lt;mirror&gt;
      &lt;id&gt;Nexus&lt;/id&gt;
      &lt;name&gt;Nexus Public Mirror&lt;/name&gt;
      &lt;url&gt;http://nexus-GUID-nexus.apps.shared-dev.dev.openshift.opentlc.com/repository/maven-all-public/&lt;/url&gt;
      &lt;mirrorOf&gt;*&lt;/mirrorOf&gt;
    &lt;/mirror&gt;
  &lt;/mirrors&gt;
  &lt;servers&gt;
  &lt;server&gt;
    &lt;id&gt;nexus&lt;/id&gt;
    &lt;username&gt;admin&lt;/username&gt;
    &lt;password&gt;app_deploy&lt;/password&gt;
  &lt;/server&gt;
&lt;/servers&gt;
&lt;/settings&gt;</code></pre></div></div>
<div class="admonitionblock tip"><table><tr><td class="icon"><i class="icon-tip" title="Tip"></i></td><td class="content">This file is located in the <code>$HOME/openshift-tasks</code> directory.</td></tr></table></div></li><li><p>Also change the <code>nexus_openshift_settings.xml</code> to point to the <em>internal</em> Nexus URL (don&#8217;t forget to replace <code>GUID</code> with your assigned GUID).
Replace <code>admin123</code> with the <code>admin</code> user password <code>app_deploy</code> that you set earlier.</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="xml language-xml">&lt;?xml version="1.0"?&gt;
&lt;settings&gt;
  &lt;mirrors&gt;
    &lt;mirror&gt;
      &lt;id&gt;Nexus&lt;/id&gt;
      &lt;name&gt;Nexus Public Mirror&lt;/name&gt;
      &lt;url&gt;http://nexus.GUID-nexus.svc.cluster.local:8081/repository/maven-all-public/&lt;/url&gt;
      &lt;mirrorOf&gt;*&lt;/mirrorOf&gt;
    &lt;/mirror&gt;
  &lt;/mirrors&gt;
  &lt;servers&gt;
    &lt;server&gt;
      &lt;id&gt;nexus&lt;/id&gt;
      &lt;username&gt;admin&lt;/username&gt;
      &lt;password&gt;app_deploy&lt;/password&gt;
    &lt;/server&gt;
  &lt;/servers&gt;
&lt;/settings&gt;</code></pre></div></div></li><li><p>Commit and push the updated settings files to Gogs:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="bash language-bash">git commit -m "Updated Nexus Settings" nexus_settings.xml nexus_openshift_settings.xml
git push gogs master</code></pre></div></div></li></ol></div></div></div></div>
<div class="sect1"><h2 id="_set_up_jenkins">Set Up Jenkins</h2><div class="sectionbody"><div class="olist arabic"><ol class="arabic"><li><p>Create a new project called <code>GUID-jenkins</code> with a display name of <code>GUID Shared Jenkins</code>.</p></li><li><p>Create a new persistent Jenkins instance with the following requirements:</p><div class="ulist"><ul><li><p>A persistent persistent volume claim of 4 GB.</p></li><li><p>Set the parameter <code>DISABLE_ADMINISTRATIVE_MONITORS=true</code> to turn of update checking of Jenkins plugins.</p></li><li><p>Set the CPU request to 500m and CPU limit to 2 cores.</p></li><li><p>Set the memory request to 1Gi and memory limit to 2Gi.</p></li></ul></div></li></ol></div></div></div>
<div class="sect1"><h2 id="_work_with_custom_jenkins_agent_pod">Work with Custom Jenkins Agent Pod</h2><div class="sectionbody"><div class="sect2"><h3 id="_create_custom_jenkins_agent_pod">Create Custom Jenkins Agent Pod</h3><div class="paragraph"><p>To create a custom Jenkins agent pod we will use the OpenShift build process with Docker strategy. It is much easier than building the container image locally and then pushing it to the Docker registry. We will cover different build strategies in the next chapter of the course, but for now just use the following command:</p></div>
<div class="listingblock"><div class="content"><pre class="highlight"><code class="bash language-bash">oc new-build --strategy=docker -D $'FROM registry.access.redhat.com/ubi8/go-toolset:latest as builder\n
ENV SKOPEO_VERSION=v1.0.0\n
RUN git clone -b $SKOPEO_VERSION https://github.com/containers/skopeo.git &amp;&amp; cd skopeo/ &amp;&amp; make binary-local DISABLE_CGO=1\n
FROM image-registry.openshift-image-registry.svc:5000/openshift/jenkins-agent-maven:v4.0 as final\n
USER root\n
RUN mkdir /etc/containers\n
COPY --from=builder /opt/app-root/src/skopeo/default-policy.json /etc/containers/policy.json\n
COPY --from=builder /opt/app-root/src/skopeo/skopeo /usr/bin\n
USER 1001' --name=jenkins-agent-appdev -n ${GUID}-jenkins</code></pre></div></div>
<div class="paragraph"><p>This command will build the image and automatically upload it to the cluster&#8217;s internal container registry.
It will also create an ImageStream. Check it:</p></div>
<div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">oc get is</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight"><code class="texinfo language-texinfo">NAME                   IMAGE REPOSITORY                                                                                                     TAGS   UPDATED
jenkins-agent-appdev   default-route-openshift-image-registry.apps.shared-dev4.dev4.openshift.opentlc.com/wk-jenkins/jenkins-agent-appdev
jenkins-agent-maven    default-route-openshift-image-registry.apps.shared-dev4.dev4.openshift.opentlc.com/wk-jenkins/jenkins-agent-maven    v4.0   11 seconds ago</code></pre></div></div></div>
<div class="sect2"><h3 id="_register_custom_agent_pod_in_jenkins">Register Custom Agent Pod in Jenkins</h3><div class="paragraph"><p>When your customized Maven agent pod is available in the OpenShift Container Registry, you need to tell Jenkins where to find it and when to use it.</p></div>
<div class="paragraph"><p>You can use the existing Maven agent image as a template and copy most of the fields from the existing image.</p></div>
<div class="paragraph"><p>In the Jenkins UI:</p></div>
<div class="ulist"><ul><li><p>Select <strong>Manage Jenkins</strong>.</p></li><li><p>Dismiss all warnings</p></li><li><p>Select <strong>Manage Nodes and Clouds</strong> &#8594; <strong>Configure Clouds</strong></p></li><li><p>Scroll down to the <strong>Add Pod Template</strong> button.</p></li><li><p>Select <strong>Add Pod Template &#8594; Kubernetes Pod Template</strong> to add a new Pod Template.</p></li></ul></div>
<div class="paragraph"><p>Make sure you get the following settings right:</p></div>
<div class="ulist"><ul><li><p><strong>Labels</strong>: This is the name that you use in your pipeline to specify this image. Suggestion: <code>maven-appdev</code>.</p></li><li><p><strong>Docker-Image</strong>: The fully qualified name of your container image. Use the OpenShift <strong>internal</strong> service name (and port). You can find the right name in the ImageStream.</p></li><li><p><strong>Memory</strong>: Use <code>2Gi</code> for the container memory request and limit.</p></li><li><p><strong>CPU</strong>: Use 1 for the cpu request and 2 for the cpu limit.</p></li><li><p><strong>Service Account</strong>: The service account for the pod to use should be set to <code>jenkins</code>.</p></li><li><p>Add an <strong>Environment Variable</strong>: <code>USE_JAVA_VERSION = java-1.8.0</code></p></li></ul></div></div>
<div class="sect2"><h3 id="_test_custom_agent_pod">Test Custom Agent Pod</h3><div class="paragraph"><p>Using a simple pipeline, you can now test that your agent pod is working properly and has <code>skopeo</code> installed.</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Create a new Jenkins job <code>Test Agent</code> of type <strong>Pipeline</strong> and use this test pipeline:</p><div class="ulist"><ul><li><p>Make sure the label you request matches the label you gave your agent definition.</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="groovy language-groovy">node('maven-appdev') {
  stage('Test skopeo') {
    sh("skopeo --version")
    sh("java -version")
    sh("oc whoami")
  }
}</code></pre></div></div></li></ul></div></li><li><p>Run the pipeline (click <strong>Build Now</strong>).</p><div class="ulist"><ul><li><p>Expect the console output to look like this (Click the Build Number, then <strong>Console Output</strong>):</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="text language-text">Started by user wkulhane-redhat.com
Running in Durability level: MAX_SURVIVABILITY
[Pipeline] Start of Pipeline
[Pipeline] node
Still waiting to schedule task
‘Jenkins’ doesn’t have label ‘maven-appdev’
Agent maven-appdev-tp2kh is provisioned from template Kubernetes Pod Template
---
apiVersion: "v1"
kind: "Pod"
metadata:
  annotations: {}
  labels:
    jenkins: "slave"
    jenkins/maven-appdev: "true"
  name: "maven-appdev-tp2kh"
spec:
  containers:
  - args:
    - "********"
    - "maven-appdev-tp2kh"
    env:
    - name: "JENKINS_SECRET"
      value: "********"
    - name: "JENKINS_TUNNEL"
      value: "172.30.224.175:50000"
    - name: "JENKINS_AGENT_NAME"
      value: "maven-appdev-tp2kh"
    - name: "USE_JAVA_VERSION"
      value: "java-1.8.0"
    - name: "JENKINS_NAME"
      value: "maven-appdev-tp2kh"
    - name: "JENKINS_AGENT_WORKDIR"
      value: "/tmp"
    - name: "JENKINS_URL"
      value: "http://172.30.182.151:80/"
    - name: "HOME"
      value: "/home/jenkins"
    image: "image-registry.openshift-image-registry.svc:5000/wk-jenkins/jenkins-agent-appdev"
    imagePullPolicy: "IfNotPresent"
    name: "jnlp"
    resources:
      limits:
        memory: "2Gi"
        cpu: "2"
      requests:
        memory: "2Gi"
        cpu: "1"
    securityContext:
      privileged: false
    tty: false
    volumeMounts:
    - mountPath: "/tmp"
      name: "workspace-volume"
      readOnly: false
    workingDir: "/tmp"
  nodeSelector: {}
  restartPolicy: "Never"
  serviceAccount: "jenkins"
  volumes:
  - emptyDir:
      medium: ""
    name: "workspace-volume"

Running on maven-appdev-tp2kh in /tmp/workspace/Test Agent
[Pipeline] {
[Pipeline] stage
[Pipeline] { (Test skopeo)
[Pipeline] sh
+ skopeo --version
skopeo version 1.0.0 commit: bd162028cd83ceecd8915736f2d66d5ca73ee54a
[Pipeline] sh
+ java -version
openjdk version "1.8.0_252"
OpenJDK Runtime Environment (build 1.8.0_252-b09)
OpenJDK 64-Bit Server VM (build 25.252-b09, mixed mode)
[Pipeline] sh
+ oc whoami
system:serviceaccount:wk-jenkins:jenkins
[Pipeline] }
[Pipeline] // stage
[Pipeline] }
[Pipeline] // node
[Pipeline] End of Pipeline
Finished: SUCCESS</code></pre></div></div></li></ul></div></li></ol></div></div></div></div>
<div class="sect1"><h2 id="_use_a_configmap_to_register_agent_pod">Use a ConfigMap to register Agent Pod</h2><div class="sectionbody"><div class="paragraph"><p>When deploying the Jenkins environment programmatically you can not edit the system configuration like you did above. Therefore you will need to either embed the podTemplate definition into the Jenkins Pipeline - or create a ConfigMap with the definition for the pod template.</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Create an XML File <code>$HOME/podTemplate.xml</code> for your pod Template. Ensure the following parameters are set:</p><div class="ulist"><ul><li><p><strong>Labels</strong>: Use <code>maven-skopeo-agent</code> as the name that you use in your pipeline to specify this image.</p></li><li><p><strong>Image</strong>: The fully qualified name of your container image. Use the OpenShift <strong>internal</strong> service name (and port). You can find the right name in the ImageStream.</p></li><li><p><strong>Memory</strong>: Use <code>2Gi</code> for the container memory request and limit.</p></li><li><p><strong>CPU</strong>: Use 1 for the cpu request and 2 for the cpu limit.</p></li><li><p><strong>Service Account</strong>: The service account for the pod to use should be set to <code>jenkins</code>.</p></li><li><p>Add an <strong>Environment Variable</strong>: <code>USE_JAVA_VERSION = java-1.8.0</code></p></li></ul></div></li><li><p>Create a ConfigMap called <code>maven-skopeo-agent</code> containing the file podTemplate.xml.</p></li><li><p>Label the ConfigMap with <code>role=jenkins-slave</code> for Jenkins to pick up the definition.</p></li></ol></div>
<div class="sect2"><h3 id="_test_second_agent_pod">Test Second Agent Pod</h3><div class="paragraph"><p>If you want you can double check that the OpenShift sync plugin updated the Jenkins configuration. Simply check under <strong>Manage Jenkins &#8594; Manage Nodes and Clouds &#8594; Configure Clouds</strong> to validate that you now have four pod templates defined.</p></div>
<div class="paragraph"><p>Using a simple pipeline, you can now once again test that your agent pod is working properly and has <code>skopeo</code> installed. This time use label <code>maven-skopeo-agent</code>.</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Create a new Jenkins job <code>Test Agent 2</code> of type <strong>Pipeline</strong> and use this test pipeline:</p><div class="ulist"><ul><li><p>Make sure the label you request matches the label you gave your agent definition.</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="groovy language-groovy">node('maven-skopeo-agent') {
  stage('Test skopeo') {
    sh("skopeo --version")
    sh("java -version")
    sh("oc whoami")
  }
}</code></pre></div></div></li></ul></div></li><li><p>Run the pipeline (click <strong>Build Now</strong>).</p></li><li><p>Double check the build output to ensure everything worked as expected.</p></li></ol></div></div></div></div>
<div class="sect1"><h2 id="_test_local_workstation_build">Test Local Workstation Build</h2><div class="sectionbody"><div class="paragraph"><p>In order to verify that all of your build tools are set up correctly, it is a good idea to run a test from your client VM using Nexus and SonarQube from your OpenShift installation.
To be able to perform this step on your client VM the following software tools should be installed.
Try to run them by checking their versions and if some of them are not installed, install them:</p></div>
<div class="ulist"><ul><li><p>Apache Maven</p><div class="ulist"><ul><li><p>Check: <code>mvn --version</code></p></li><li><p>Install: <code>wget http://apache.mirrors.lucidnetworks.net/maven/maven-3/3.6.3/binaries/apache-maven-3.6.3-bin.tar.gz -P $HOME; sudo tar xzvf $HOME/apache-maven-3.6.3-bin.tar.gz -C /opt; export PATH=/opt/apache-maven-3.6.3/bin:$PATH</code></p></li></ul></div></li><li><p>Java Development Kit</p><div class="ulist"><ul><li><p>Check: <code>javac -version</code></p></li><li><p>Install: <code>sudo yum install java-1.8.0-openjdk-devel -y</code></p></li></ul></div></li><li><p>Skopeo:</p><div class="ulist"><ul><li><p>Check: <code>skopeo --version</code></p></li><li><p>Install: <code>sudo yum install skopeo -y</code></p></li></ul></div></li></ul></div>
<div class="paragraph"><p>Now, build the application.</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>First, make sure you can build the <code>openshift-tasks</code> application:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="bash language-bash">cd $HOME/openshift-tasks
mvn clean install -DskipTests=true -s ./nexus_settings.xml</code></pre></div></div>
<div class="admonitionblock note"><table><tr><td class="icon"><i class="icon-note" title="Note"></i></td><td class="content">Make sure to double-check the output of the build to verify that your Maven dependencies come from Nexus and not the public Internet repository.</td></tr></table></div></li><li><p>Run the unit tests:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="bash language-bash">mvn test -s ./nexus_settings.xml</code></pre></div></div>
<div class="admonitionblock note"><table><tr><td class="icon"><i class="icon-note" title="Note"></i></td><td class="content">Make sure to double-check the output of the build to verify that your Maven dependencies come from Nexus and not the public Internet repository.</td></tr></table></div></li><li><p>Run the Maven deploy tests:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="bash language-bash">mvn -s ./nexus_settings.xml deploy -DskipTests=true \
-DaltDeploymentRepository=nexus::default::http://$(oc get route nexus -n ${GUID}-nexus --template='{{ .spec.host }}')/repository/releases</code></pre></div></div></li><li><p>Run the Nexus Docker registry tests by copying the jenkins agent image you built earlier into the Nexus Docker registry (ensure your cluster URL is correct for the cluster you are working on).</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="bash language-bash">export REGISTRY=default-route-openshift-image-registry.apps.$(oc whoami --show-server | cut -d. -f2- | cut -d: -f1)

skopeo copy --src-tls-verify=false --dest-tls-verify=false --src-creds=openshift:$(oc whoami -t) --dest-creds=admin:app_deploy docker://${REGISTRY}/${GUID}-jenkins/jenkins-agent-appdev docker://$(oc get route nexus-registry -n ${GUID}-nexus --template='{{ .spec.host }}')/${GUID}-jenkins/jenkins-agent-maven-appdev</code></pre></div></div>
<div class="admonitionblock tip"><table><tr><td class="icon"><i class="icon-tip" title="Tip"></i></td><td class="content">If you get an invalid username/password in this step, check the Nexus realm security settings in your Nexus registry and make sure that <code>Docker Bearer Token Realm</code> is enabled.</td></tr></table></div></li><li><p>Run the code analysis tests (you may ignore any errors complaining about a missing <code>node</code>):</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="bash language-bash">mvn sonar:sonar -s ./nexus_settings.xml -Dsonar.host.url=http://$(oc get route sonarqube -n ${GUID}-sonarqube --template='{{ .spec.host }}')</code></pre></div></div>
<div class="ulist"><ul><li><p>When the build and tests succeed without error, your environment is ready.</p></li></ul></div></li></ol></div>
<div class="admonitionblock important"><table><tr><td class="icon"><i class="icon-important" title="Important"></i></td><td class="content">Do not delete any of these projects. You use this infrastructure throughout the class.</td></tr></table></div>
<div class="paragraph"><p>&lt;blnk&gt;Congratulations!&lt;/blink&gt;  You have completed a very long and difficult lab.  Pat yourself on the back, have a beverage, and we&#8217;ll see you for the next module.</p></div></div></div></div><div id="footer"><div id="footer-text"><br>Build Version: 320476264974a6cca3ad0f4aa6f0e9c81580a6ec   :   Last updated 2020-08-25 16:05:59 EDT</div></div></body></html>